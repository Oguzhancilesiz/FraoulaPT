@{
    ViewData["Title"] = ViewBag.Title ?? "Admin Panel";
    var profilePhoto = ViewBag.ProfilePhotoUrl as string ?? "/uploads/user-default.jpg";
    var profileName = ViewBag.ProfileName as string ?? "Admin";

    int unansweredQ = ViewBag.UnansweredQuestionsCount is int uq ? uq : 0;
    int pendingChats = ViewBag.PendingChatCount is int pc ? pc : 0;

    var ctrl = (ViewContext.RouteData.Values["controller"] as string) ?? "";
    var act = (ViewContext.RouteData.Values["action"] as string) ?? "";
}
<!DOCTYPE html>
<html lang="tr" data-theme="dark">
<head>
    <meta charset="UTF-8" />
    <title>@ViewData["Title"] - Admin Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Libs -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet" />

    <style>
        .table-sticky thead th {
            position: sticky;
            top: 0;
            background: var(--panel);
            z-index: 1;
        }

        /* THEME */
        :root {
            --bg: #0d0f14;
            --panel: #131720;
            --panel-2: #0f141d;
            --text: #e7edf5;
            --muted: #9aa4b2;
            --brand: #ff8800;
            --brand-2: #ffb454;
            --border: #1f2633;
            --ring: #2a3446;
            --shadow: 0 8px 30px rgba(0,0,0,.35);
        }

        html[data-theme="light"] {
            --bg: #f7f8fb;
            --panel: #ffffff;
            --panel-2: #f1f5f9;
            --text: #0f172a;
            --muted: #64748b;
            --brand: #ff8800;
            --brand-2: #ffb454;
            --border: #e2e8f0;
            --ring: #d7dee8;
            --shadow: 0 6px 22px rgba(2,8,23,.06);
        }
        @@media (prefers-color-scheme: light) {
            html: not([data-theme="dark"])

        {
            color-scheme: light;
        }

        }

        html, body {
            height: 100%
        }

        body {
            background: var(--bg);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        a {
            color: inherit;
            text-decoration: none
        }

        .ring {
            border: 1px solid var(--border)
        }

        .shadow-soft {
            box-shadow: var(--shadow)
        }

        .focusable:focus-visible {
            outline: 2px solid var(--brand);
            outline-offset: 2px;
            border-radius: .6rem
        }

        /* Topbar */
        .navbar-admin {
            background: linear-gradient(180deg,var(--panel),var(--panel-2));
            height: 64px;
            padding: 0 .8rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 1020;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 12px rgba(0,0,0,.25);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: .5rem;
            font-weight: 700
        }

            .brand .dot {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: var(--brand)
            }

        .btn-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: .4rem
        }

        .btn-ghost {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text)
        }

            .btn-ghost:hover {
                background: rgba(255,255,255,.05)
            }

        .profile-img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--border)
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            inset: 64px auto 0 0;
            width: 260px;
            background: var(--panel);
            border-right: 1px solid var(--border);
            padding: 1rem .75rem;
            overflow-y: auto;
            z-index: 1030;
            transition: transform .3s ease,width .3s ease;
        }

            .sidebar::-webkit-scrollbar {
                width: 8px
            }

            .sidebar::-webkit-scrollbar-thumb {
                background: #2a3446;
                border-radius: 8px
            }

        .menu-title {
            font-size: .75rem;
            text-transform: uppercase;
            letter-spacing: .08em;
            color: var(--muted);
            margin: .8rem .5rem .4rem
        }

        .nav-link-admin {
            display: flex;
            align-items: center;
            gap: .65rem;
            padding: .6rem .7rem;
            border-radius: .6rem;
            color: #cbd5e1;
            transition: background .15s,color .15s
        }

            .nav-link-admin i {
                opacity: .9;
                width: 20px;
                text-align: center
            }

            .nav-link-admin:hover {
                background: #1a2332;
                color: #fff
            }

            .nav-link-admin.active {
                background: linear-gradient(90deg,rgba(255,136,0,.18),rgba(255,136,0,.06));
                color: #fff;
                border: 1px solid rgba(255,136,0,.35)
            }

        /* Sidebar collapsed (desktop) */
        .sidebar.collapsed {
            width: 76px
        }

            .sidebar.collapsed .nav-text, .sidebar.collapsed .menu-title {
                display: none
            }

        .main {
            margin-left: 260px;
            transition: margin-left .3s ease
        }

            .main.collapsed {
                margin-left: 76px
            }

        /* Mobile off-canvas */
        @@media (max-width: 991.98px) {
            .sidebar {
                transform: translateX(-100%);
                inset: 64px 0 0 0;
                width: 280px
            }

                .sidebar.show {
                    transform: translateX(0)
                }

            .main {
                margin-left: 0
            }
        }

        .sidebar-overlay {
            position: fixed;
            inset: 64px 0 0 0;
            background: rgba(0,0,0,.45);
            z-index: 1025;
            display: none
        }

            .sidebar-overlay.show {
                display: block
            }

        .btn-brand {
            background: linear-gradient(90deg,var(--brand),var(--brand-2));
            border: 0;
            color: #111;
            font-weight: 700
        }

            .btn-brand:hover {
                filter: brightness(1.05)
            }

        /* Sidebar search */
        .sidebar-search {
            position: sticky;
            top: 0;
            background: var(--panel);
            padding-bottom: .5rem;
            margin-top: -.5rem
        }

            .sidebar-search input {
                background: var(--panel-2);
                border: 1px solid var(--border);
                color: var(--text)
            }

                .sidebar-search input::placeholder {
                    color: #94a3b8
                }

        /* Notification dropdown */
        .notif-tab {
            cursor: pointer;
            padding: .25rem .6rem;
            border-radius: .5rem;
            border: 1px solid var(--border);
            color: var(--muted)
        }

            .notif-tab.active {
                background: rgba(255,136,0,.12);
                color: #fff;
                border-color: rgba(255,136,0,.35)
            }

        .notif-skeleton {
            animation: shimmer 1.4s infinite linear;
            background: linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.12), rgba(255,255,255,.06));
            height: 14px;
            border-radius: 6px
        }

        @@keyframes shimmer {
            0% {
                background-position: -200px 0
            }

            100% {
                background-position: 200px 0
            }
        }

        /* Bottom mobile bar */
        .bottom-bar {
            display: none
        }

        @@media (max-width: 991.98px) {
            .bottom-bar {
                display: flex;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                height: 56px;
                background: var(--panel);
                border-top: 1px solid var(--border);
                z-index: 1040
            }

                .bottom-bar a {
                    flex: 1;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    color: var(--muted);
                    font-size: .8rem
                }

                    .bottom-bar a.active, .bottom-bar a:hover {
                        color: #fff
                    }

            body {
                padding-bottom: 56px
            }
            /* içerik altta kalmasın */
        }

        .scrolltop {
            position: fixed;
            right: 16px;
            bottom: 72px;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--panel-2);
            display: none;
            place-items: center;
            z-index: 1040
        }

            .scrolltop.show {
                display: grid
            }
    </style>
</head>
<body>
    <!-- Topbar -->
    <div class="navbar-admin">
        <div class="d-flex align-items-center gap-2">
            <button class="btn btn-ghost btn-icon d-lg-none focusable" id="toggleSidebarMobile" aria-label="Menü"><i class="bi bi-list fs-4"></i></button>
            <button class="btn btn-ghost btn-icon d-none d-lg-inline-flex focusable" id="toggleSidebarDesktop" aria-label="Daralt/Genişlet"><i class="bi bi-layout-sidebar-inset fs-5"></i></button>
            <div class="brand"><span class="dot"></span><span>Admin Panel</span></div>
        </div>

        <div class="d-flex align-items-center gap-2">
            <!-- Theme Toggle -->
            <button id="themeToggle" class="btn btn-ghost btn-icon focusable" title="Tema"><i class="bi bi-sun-fill d-none" id="icoLight"></i><i class="bi bi-moon-stars" id="icoDark"></i></button>

            <!-- 🔔 Bildirim Zili -->
            <div class="dropdown me-1">
                <button class="btn btn-ghost position-relative focusable" id="notifBell" data-bs-toggle="dropdown" aria-expanded="false" title="Bildirimler">
                    <i class="bi bi-bell fs-5"></i>
                    <span id="notifTotal" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none"></span>
                </button>
                <div class="dropdown-menu dropdown-menu-end p-0 shadow-soft" style="min-width: 360px;">
                    <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                        <strong>Bildirimler</strong>
                        <div class="d-flex gap-2">
                            <span class="notif-tab active" data-notif-tab="all">Hepsi</span>
                            <span class="notif-tab" data-notif-tab="q">Sorular</span>
                            <span class="notif-tab" data-notif-tab="c">Mesajlar</span>
                        </div>
                    </div>
                    <div id="notifList" class="list-group list-group-flush">
                        <!-- Statik kısım -->
                        <a href="/Admin/CoachQuestion/Index?filter=unanswered" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-question-circle me-2 text-warning"></i> Cevaplanmamış Sorular</span>
                            <span id="countQuestions" class="badge bg-warning text-dark">0</span>
                        </a>
                        <a href="/Admin/CoachChat/Index?filter=pending" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-chat-dots me-2 text-info"></i> Yanıt Bekleyen Mesajlar</span>
                            <span id="countChats" class="badge bg-info text-dark">0</span>
                        </a>

                        <!-- Dinamik alan (JS doldurur) -->
                        <div class="p-3" id="notifDynamic">
                            <div class="d-flex align-items-center gap-2 mb-2">
                                <div class="notif-skeleton" style="width:26px;height:26px;border-radius:50%"></div>
                                <div class="flex-grow-1">
                                    <div class="notif-skeleton" style="width:80%"></div>
                                </div>
                                <div class="notif-skeleton" style="width:48px"></div>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <div class="notif-skeleton" style="width:26px;height:26px;border-radius:50%"></div>
                                <div class="flex-grow-1">
                                    <div class="notif-skeleton" style="width:70%"></div>
                                </div>
                                <div class="notif-skeleton" style="width:48px"></div>
                            </div>
                        </div>
                    </div>
                    <div id="notifUpdated" class="p-2 text-center small text-muted border-top">—</div>
                </div>
            </div>

            <!-- Profil -->
            <div class="dropdown">
                <a href="#" class="d-flex align-items-center text-decoration-none focusable" data-bs-toggle="dropdown">
                    <img src="@profilePhoto" class="profile-img me-2" alt="profil" />
                    <span class="fw-medium d-none d-sm-inline">@profileName</span>
                    <i class="bi bi-chevron-down ms-1 d-none d-sm-inline"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-end shadow-soft" style="min-width:220px">
                    <li><h6 class="dropdown-header">@profileName</h6></li>
                    <li><a class="dropdown-item" asp-controller="Profile" asp-action="Index"><i class="bi bi-person-circle me-2"></i>Profilim</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item text-danger" asp-controller="Auth" asp-action="SignOut"><i class="bi bi-box-arrow-right me-2"></i>Çıkış Yap</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-search mb-3">
            <input id="sidebarSearch" class="form-control form-control-sm" placeholder="Menüde ara (ör. egzersiz)" />
        </div>

        <div class="menu-title">Genel</div>
        <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="nav-link-admin @(ctrl=="Dashboard" ? "active" : "")" data-text="dashboard genel ana sayfa">
            <i class="bi bi-speedometer2"></i><span class="nav-text">Dashboard</span>
        </a>

        <div class="menu-title">Kullanıcılar</div>
        <a asp-area="Admin" asp-controller="User" asp-action="Index" class="nav-link-admin @(ctrl=="User" ? "active" : "")" data-text="kullanıcılar user">
            <i class="bi bi-people"></i><span class="nav-text">Kullanıcılar</span>
        </a>
        <a asp-area="Admin" asp-controller="UserWeeklyForm" asp-action="Index" class="nav-link-admin @(ctrl=="UserWeeklyForm" ? "active" : "")" data-text="aylık vücut formları ölçüm">
            <i class="bi bi-journal-check"></i><span class="nav-text">Aylık Vücut Formları</span>
        </a>

        <div class="menu-title">Sohbet & Soru</div>
        <a asp-area="Admin" asp-controller="CoachChat" asp-action="Index" class="nav-link-admin @(ctrl=="CoachChat" ? "active" : "")" data-text="canlı sohbet chat">
            <i class="bi bi-chat-dots"></i><span class="nav-text">Canlı Sohbet</span>
        </a>
        <a asp-area="Admin" asp-controller="CoachQuestion" asp-action="Index" class="nav-link-admin @(ctrl=="CoachQuestion" ? "active" : "")" data-text="soru cevap question">
            <i class="bi bi-question-circle"></i><span class="nav-text">Soru-Cevap</span>
        </a>

        <div class="menu-title">Egzersizler</div>
        <a asp-area="Admin" asp-controller="Exercise" asp-action="Index" class="nav-link-admin @(ctrl=="Exercise" && act!="Create" ? "active" : "")" data-text="egzersiz liste exercise">
            <i class="bi bi-bicycle"></i><span class="nav-text">Egzersiz Listele</span>
        </a>
        <a asp-area="Admin" asp-controller="Exercise" asp-action="Create" class="nav-link-admin @(ctrl=="Exercise" && act=="Create" ? "active" : "")" data-text="egzersiz ekle create">
            <i class="bi bi-plus-circle"></i><span class="nav-text">Egzersiz Ekle</span>
        </a>
        <a asp-area="Admin" asp-controller="ExerciseCategory" asp-action="Index" class="nav-link-admin @(ctrl=="ExerciseCategory" ? "active" : "")" data-text="kategoriler category">
            <i class="bi bi-tags"></i><span class="nav-text">Egzersiz Kategorileri</span>
        </a>

        <div class="menu-title">Programlar</div>
        <a asp-area="Admin" asp-controller="WorkoutProgram" asp-action="Index" class="nav-link-admin @(ctrl=="WorkoutProgram" ? "active" : "")" data-text="antrenmanlar program">
            <i class="bi bi-calendar-check"></i><span class="nav-text">Antrenmanlar</span>
        </a>

        <div class="menu-title">Paketler</div>
        <a asp-area="Admin" asp-controller="Package" asp-action="Index" class="nav-link-admin @(ctrl=="Package" ? "active" : "")" data-text="paketler package">
            <i class="bi bi-box-seam"></i><span class="nav-text">Paketler</span>
        </a>
        <a asp-area="Admin" asp-controller="ExtraPackageOption" asp-action="Index" class="nav-link-admin @(ctrl=="ExtraPackageOption" ? "active" : "")" data-text="ek paketler extra">
            <i class="bi bi-puzzle"></i><span class="nav-text">Ek Paketler</span>
        </a>

        <div class="menu-title">Raporlar</div>
        <a asp-area="Admin" asp-controller="Reports" asp-action="Index" class="nav-link-admin @(ctrl=="Reports" ? "active" : "")" data-text="raporlar reports">
            <i class="bi bi-bar-chart-line"></i><span class="nav-text">Raporlar</span>
        </a>

        <div class="menu-title">Ayarlar</div>
        <a asp-controller="Profile" asp-action="Index" class="nav-link-admin @(ctrl=="Profile" ? "active" : "")" data-text="profilim profile">
            <i class="bi bi-person-circle"></i><span class="nav-text">Profilim</span>
        </a>
        <a asp-controller="Auth" asp-action="SignOut" class="nav-link-admin text-danger" data-text="çıkış logout">
            <i class="bi bi-box-arrow-right"></i><span class="nav-text">Çıkış Yap</span>
        </a>
    </aside>
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main -->
    <main id="main" class="main">
        @RenderBody()
    </main>

    <!-- Bottom mobile bar -->
    <nav class="bottom-bar d-lg-none">
        <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="@(ctrl=="Dashboard" ? "active" : "")"><i class="bi bi-speedometer2 fs-5"></i><small>Panel</small></a>
        <a asp-area="Admin" asp-controller="User" asp-action="Index" class="@(ctrl=="User" ? "active" : "")"><i class="bi bi-people fs-5"></i><small>Users</small></a>
        <a asp-area="Admin" asp-controller="CoachChat" asp-action="Index" class="@(ctrl=="CoachChat" ? "active" : "")"><i class="bi bi-chat-dots fs-5"></i><small>Sohbet</small></a>
        <a href="javascript:void(0)" id="openMobileMenu"><i class="bi bi-list fs-5"></i><small>Menü</small></a>
    </nav>
    <button id="btnScrollTop" class="scrolltop"><i class="bi bi-arrow-up"></i></button>

    <!-- Komut Paleti (Ctrl+K) -->
    <div class="modal fade" id="cmdKModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light border border-secondary rounded-3">
                <div class="modal-header border-0">
                    <input id="cmdKInput" class="form-control bg-dark text-light ring" placeholder="Ara ve git... (menü adı yaz)" />
                </div>
                <div class="modal-body p-0">
                    <div id="cmdKList" class="list-group list-group flush"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- ✅ Öneri: Yerel kullan -->
    <!-- <script src="~/js/signalr.min.js"></script> -->
    @if (TempData["AlertMessage"] != null)
    {
        <script>
            Swal.fire({
                title: @Html.Raw(Json.Serialize(TempData["AlertTitle"] ?? "")),
                text: @Html.Raw(Json.Serialize(TempData["AlertMessage"])),
                icon: @Html.Raw(Json.Serialize(TempData["AlertType"] ?? "info")),
                confirmButtonText: 'Tamam',
                timer: 3000
            });
        </script>
    }

    <script>
        (function(){
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            const main = document.getElementById('main');
            const btnMobile = document.getElementById('toggleSidebarMobile');
            const btnDesktop = document.getElementById('toggleSidebarDesktop');
            const openMobileMenu = document.getElementById('openMobileMenu');
            const search = document.getElementById('sidebarSearch');
            const btnScrollTop = document.getElementById('btnScrollTop');

            // Theme toggle
            const themeBtn = document.getElementById('themeToggle');
            const icoLight = document.getElementById('icoLight');
            const icoDark  = document.getElementById('icoDark');
            const setTheme = (v)=>{ document.documentElement.setAttribute('data-theme', v); localStorage.setItem('theme', v); icoLight.classList.toggle('d-none', v!=='light'); icoDark.classList.toggle('d-none', v==='light'); };
            setTheme(localStorage.getItem('theme') || 'dark');
            themeBtn?.addEventListener('click', ()=> setTheme(document.documentElement.getAttribute('data-theme')==='dark' ? 'light':'dark'));

            // Desktop collapsed
            const KEY='admin.sidebar.collapsed';
            const isLg = () => window.matchMedia('(min-width: 992px)').matches;
            const setCollapsed = (val)=>{ if(val){ sidebar.classList.add('collapsed'); main.classList.add('collapsed'); localStorage.setItem(KEY,'1'); } else { sidebar.classList.remove('collapsed'); main.classList.remove('collapsed'); localStorage.setItem(KEY,'0'); } };
            if(isLg() && localStorage.getItem(KEY)==='1') setCollapsed(true);
            btnDesktop?.addEventListener('click', ()=> setCollapsed(!sidebar.classList.contains('collapsed')));

            // Mobile off-canvas
            const openMobile = ()=>{ sidebar.classList.add('show'); overlay.classList.add('show'); document.body.style.overflow='hidden'; }
            const closeMobile = ()=>{ sidebar.classList.remove('show'); overlay.classList.remove('show'); document.body.style.overflow=''; }
            btnMobile?.addEventListener('click', openMobile);
            openMobileMenu?.addEventListener('click', openMobile);
            overlay?.addEventListener('click', closeMobile);
            document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMobile(); });
            window.addEventListener('resize', ()=>{ if(!isLg()) setCollapsed(false); closeMobile(); });

            // Sidebar search
            search?.addEventListener('input', function(){
                const q = this.value.toLowerCase();
                document.querySelectorAll('.nav-link-admin').forEach(a=>{
                    const txt = (a.dataset.text || a.textContent).toLowerCase();
                    a.style.display = txt.includes(q) ? '' : 'none';
                });
            });

            // Scroll to top
            window.addEventListener('scroll', ()=>{ btnScrollTop.classList.toggle('show', window.scrollY > 400); });
            btnScrollTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

            // Command palette
            const cmdModal = new bootstrap.Modal(document.getElementById('cmdKModal'));
            const cmdInput = document.getElementById('cmdKInput');
            const cmdList  = document.getElementById('cmdKList');
            function buildCmdList(){
                cmdList.innerHTML = '';
                document.querySelectorAll('.nav-link-admin').forEach(a=>{
                    if(a.style.display==='none') return;
                    const li = document.createElement('a');
                    li.href = a.getAttribute('href') || a.href || '#';
                    li.className = 'list-group-item list-group-item-action bg-dark text-light border-secondary';
                    li.innerHTML = `<i class="${a.querySelector('i')?.className||'bi bi-link-45deg'} me-2"></i>${a.textContent.trim()}`;
                    cmdList.appendChild(li);
                });
            }
            function filterCmdList(q){
                const items = cmdList.querySelectorAll('a'); let first=null;
                items.forEach(it=>{
                    const ok = it.textContent.toLowerCase().includes(q.toLowerCase());
                    it.style.display = ok ? '' : 'none';
                    if(ok && !first) first = it;
                });
                return first;
            }
            document.addEventListener('keydown', (e)=>{
                if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='k'){
                    e.preventDefault(); buildCmdList(); cmdModal.show(); setTimeout(()=>cmdInput.focus(),150);
                }
            });
            cmdInput?.addEventListener('input', function(){ filterCmdList(this.value); });
            cmdInput?.addEventListener('keydown', function(e){
                if(e.key==='Enter'){ const first = filterCmdList(this.value); if(first){ window.location.href = first.href; cmdModal.hide(); } }
            });

            // Notifications (UI only – backend sonra)
            const notifTabs = document.querySelectorAll('.notif-tab');
            let notifFilter = 'all';
            notifTabs.forEach(t=> t.addEventListener('click', ()=>{
                notifTabs.forEach(x=>x.classList.remove('active'));
                t.classList.add('active');
                notifFilter = t.getAttribute('data-notif-tab');
                // burada dilersen listedeki item'ları filtreleyebilirsin
            }));
            // Skeleton kaldırma örneği:
            setTimeout(()=>{ document.getElementById('notifDynamic').innerHTML = '<div class="p-3 text-muted">Son 5 kayıt burada görünecek.</div>'; }, 600);

            // (Bildirim fetch/signalr kodunu sonra ekleriz)
        })();

        // Toastify helper
        document.addEventListener("DOMContentLoaded", function () {
            var message = '@Html.Raw(TempData["message"])';
            var type = '@TempData["messageType"]';
            if (message) {
                Toastify({
                    text: message, duration: 3000, gravity: "top", position: "center",
                    backgroundColor: type === "success" ? "#22c55e" :
                                     type === "error" ? "#ef4444" :
                                     type === "warning" ? "#f59e0b" : "#3b82f6",
                    close: true, style:{borderRadius:"12px",padding:"14px 18px"}
                }).showToast();
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
