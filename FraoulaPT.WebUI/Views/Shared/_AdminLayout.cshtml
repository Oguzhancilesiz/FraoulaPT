@{
    ViewData["Title"] = ViewBag.Title ?? "Admin Panel";
    var profilePhoto = ViewBag.ProfilePhotoUrl as string ?? "/img/default-avatar.png";
    var profileName = ViewBag.ProfileName as string ?? "Admin";
}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>@ViewData["Title"] - Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
    <style>
        body {
            background: #f7f8fa;
        }

        .sidebar-sub-link {
            color: #ffe299 !important;
            font-size: 0.98rem;
            border-radius: 5px;
            margin-bottom: 2px;
            transition: background .16s, color .16s;
        }

            .sidebar-sub-link.active,
            .sidebar-sub-link:hover {
                color: #ff8800 !important;
                background: #fff1e5 !important;
            }


        .sidebar {
            background: linear-gradient(135deg, #1b2838 80%, #ff8800 100%);
            min-height: 100vh;
            color: #fff;
            width: 240px;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1010;
            transition: all .3s;
        }

            .sidebar a {
                color: #ffd26c;
                display: block;
                padding: 12px 18px;
                border-radius: 7px;
                margin-bottom: 10px;
                font-size: 1rem;
                transition: background .2s, color .2s;
                text-decoration: none;
            }

                .sidebar a.active, .sidebar a:hover {
                    color: #ff8800;
                    background: #fff;
                }

            .sidebar .sidebar-title {
                font-weight: bold;
                font-size: 1.4rem;
                margin-bottom: 2rem;
                color: #ff8800;
                letter-spacing: 1px;
            }

        .main {
            margin-left: 240px;
            padding: 38px 20px 24px 20px;
            min-height: 100vh;
            transition: margin .3s;
        }

        .profile-img {
            width: 42px;
            height: 42px;
            object-fit: cover;
            border-radius: 50%;
            border: 2px solid #fff;
            background: #eee;
        }

        .profile-name {
            color: #fff;
            font-weight: 500;
            margin-left: 10px;
        }

        .navbar-admin {
            background: #fff;
            border-bottom: 1px solid #ececec;
            height: 62px;
            z-index: 1030;
        }

            .navbar-admin .navbar-brand {
                color: #ff8800;
                font-weight: bold;
                font-size: 1.1rem;
                margin-right: 2rem;
            }

        .profile-dropdown .dropdown-menu {
            min-width: 180px;
            font-size: .96rem;
        }
        media (max-width: 991.98px) {
            .sidebar

        {
            left: -260px;
        }

        .sidebar.show {
            left: 0;
        }

        .main {
            margin-left: 0;
        }

        .navbar-admin {
            left: 0;
        }

        }

        .sidebar-toggle {
            font-size: 1.5rem;
            color: #ff8800;
            background: none;
            border: none;
            margin-right: 18px;
            outline: none;
        }
    </style>
</head>
<body>
    <!-- Top Navbar -->
    <nav class="navbar navbar-admin navbar-expand-lg sticky-top shadow-sm px-3">
        <button class="sidebar-toggle d-lg-none me-2" id="sidebarToggleBtn">
            <i class="bi bi-list"></i>
        </button>
        <span class="navbar-brand d-none d-lg-inline"><i class="bi bi-gear"></i> Admin Panel</span>
        <div class="ms-auto d-flex align-items-center">
            <div class="dropdown profile-dropdown">
                <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <img src="@profilePhoto" class="profile-img me-2" alt="profil" />
                    <span class="profile-name d-none d-md-inline">@profileName</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end mt-2 shadow">
                    <li>
                        <a class="dropdown-item" asp-controller="Profile" asp-action="Index"><i class="bi bi-person-lines-fill me-2"></i> Profilim</a>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <a class="dropdown-item text-danger" asp-controller="Account" asp-action="SignOut">
                            <i class="bi bi-box-arrow-right me-2"></i> Çıkış Yap
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Sidebar -->
    <div class="sidebar p-4 d-flex flex-column align-items-start" id="sidebarPanel">
        <div class="sidebar-title"><i class="bi bi-person-lock"></i> Admin Panel</div>
        <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"] as string == "Dashboard" ? "active" : "")">
            <i class="bi bi-speedometer2"></i> Dashboard
        </a>
        <a asp-area="Admin" asp-controller="User" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"] as string == "User" ? "active" : "")">
            <i class="bi bi-people"></i> Kullanıcılar
        </a>
        <a asp-area="Admin" asp-controller="UserWeeklyForm" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"] as string == "Form" ? "active" : "")">
            <i class="bi bi-journal-check"></i> Formlar
        </a>

        <!-- Kategoriler Menüsü -->
        <a class="d-flex justify-content-between align-items-center sidebar-link" data-bs-toggle="collapse" href="#collapseCategories" role="button" aria-expanded="false" aria-controls="collapseCategories">
            <span><i class="bi bi-tags"></i> Egzersiz Kategorileri</span>
            <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse ms-2 mb-2" id="collapseCategories">
            <a asp-area="Admin" asp-controller="ExerciseCategory" asp-action="Create" class="sidebar-sub-link d-block ps-4 py-2 @(ViewContext.RouteData.Values["controller"] as string == "ExerciseCategory" && ViewContext.RouteData.Values["action"] as string == "Create" ? "active" : "")">
                <i class="bi bi-plus-square me-1"></i> Egzersiz Kategorisi Ekle
            </a>
            <a asp-area="Admin" asp-controller="ExerciseCategory" asp-action="Index" class="sidebar-sub-link d-block ps-4 py-2 @(ViewContext.RouteData.Values["controller"] as string == "ExerciseCategory" && ViewContext.RouteData.Values["action"] as string == "Index" ? "active" : "")">
                <i class="bi bi-list-ul me-1"></i> Egzersiz Kategorisi Listele
            </a>
        </div>

        <!-- Egzersiz Hareketleri Menüsü -->
        <a class="d-flex justify-content-between align-items-center sidebar-link" data-bs-toggle="collapse" href="#collapseExercises" role="button" aria-expanded="false" aria-controls="collapseExercises">
            <span><i class="bi bi-bicycle"></i> Egzersiz Hareketleri</span>
            <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse ms-2 mb-2" id="collapseExercises">
            <a asp-area="Admin" asp-controller="Exercise" asp-action="Index" class="sidebar-sub-link d-block ps-4 py-2 @(ViewContext.RouteData.Values["controller"] as string == "Exercise" && ViewContext.RouteData.Values["action"] as string == "Index" ? "active" : "")">
                <i class="bi bi-list-task me-1"></i> Hareket Listele
            </a>
            <a asp-area="Admin" asp-controller="Exercise" asp-action="Create" class="sidebar-sub-link d-block ps-4 py-2 @(ViewContext.RouteData.Values["controller"] as string == "Exercise" && ViewContext.RouteData.Values["action"] as string == "Create" ? "active" : "")">
                <i class="bi bi-plus-circle me-1"></i> Yeni Hareket Ekle
            </a>
        </div>

        <a asp-area="Admin" asp-controller="WorkoutProgram" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"] as string == "WorkoutProgram" ? "active" : "")">
            <i class="bi bi-list-task"></i> Antrenmanlar
        </a>
        <a asp-area="Admin" asp-controller="Reports" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"] as string == "Reports" ? "active" : "")">
            <i class="bi bi-file-earmark-bar-graph"></i> Raporlar
        </a>
        <a asp-controller="Account" asp-action="SignOut">
            <i class="bi bi-box-arrow-right"></i> Çıkış
        </a>

    </div>
    <!-- Main Content -->
    <div class="main">
        @RenderBody()
    </div>
    <!-- Toastify & Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
        // Sidebar toggle (mobil)
        $("#sidebarToggleBtn").on("click", function () {
            $("#sidebarPanel").toggleClass("show");
        });

        // Toastify messages
        document.addEventListener("DOMContentLoaded", function () {
            var message = '@Html.Raw(TempData["message"])';
            var type = '@TempData["messageType"]';
            if (message) {
                Toastify({
                    text: message,
                    duration: 3000,
                    gravity: "top",
                    position: "center",
                    backgroundColor: type === "success" ? "green" :
                                     type === "error" ? "red" :
                                     type === "warning" ? "orange" : "blue",
                    close: true,
                    style: {
                        background: "linear-gradient(to right, #00b09b, #96c93d)",
                        fontSize: "16px",
                        fontFamily: "Arial, sans-serif",
                        borderRadius: "10px",
                        padding: "16px"
                    }
                }).showToast();
            }
        });
    </script>
    @await RenderSectionAsync("Scripts", false)
</body>
</html>
