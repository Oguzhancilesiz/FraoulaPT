@{
    string fullName = User.FindFirst("FullName")?.Value ?? "Kullanıcı";
    string profilePhoto = User.FindFirst("ProfilePhotoUrl")?.Value ?? "/uploads/user-default.jpg";
}

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - FraoulaPT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        :root {
            --pt-orange: #ff8800;
            --pt-orange-dark: #d37000;
            --pt-bg: #f7f9fa;
            --pt-darknavy: #292e49;
        }

        body {
            background: var(--pt-bg);
        }

        /* Yeni Modern Desktop Navbar */
        .app-navbar {
            background: linear-gradient(90deg, #536976 0, #292e49 100%);
            min-height: 68px;
            box-shadow: 0 3px 24px #292e4922;
            border-bottom-left-radius: 22px;
            border-bottom-right-radius: 22px;
        }

            .app-navbar .navbar-brand {
                font-size: 1.5rem;
                font-weight: 600;
                letter-spacing: 0.02em;
                color: #fff;
                display: flex;
                align-items: center;
                gap: 14px;
                padding-right: 28px;
            }

        .navbar-brand img {
            width: 48px !important;
            margin-right: 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px #0001;
        }

        .navbar-nav {
            gap: 24px;
        }

            .navbar-nav .nav-item {
                display: flex;
                align-items: center;
            }

            .navbar-nav .nav-link {
                color: #fff !important;
                font-weight: 500;
                padding: 10px 18px !important;
                border-radius: 14px;
                font-size: 1.08rem;
                display: flex;
                align-items: center;
                gap: 10px;
                transition: all .2s cubic-bezier(.55,.1,.65,.92);
                position: relative;
                background: none !important;
                box-shadow: none;
            }

                .navbar-nav .nav-link.active,
                .navbar-nav .nav-link:focus,
                .navbar-nav .nav-link:hover {
                    color: var(--pt-orange) !important;
                    background: rgba(255,136,0,0.07) !important;
                }

                    .navbar-nav .nav-link.active:after,
                    .navbar-nav .nav-link:hover:after {
                        content: '';
                        position: absolute;
                        left: 18px;
                        right: 18px;
                        bottom: 2px;
                        height: 3px;
                        border-radius: 2px;
                        background: linear-gradient(90deg, var(--pt-orange) 30%, #ffd26c 100%);
                        opacity: .9;
                        transition: all .19s cubic-bezier(.55,.1,.65,.92);
                    }

                .navbar-nav .nav-link .bi {
                    font-size: 1.23rem;
                    margin-right: 6px;
                }
        media (max-width:1200px) {
            .navbar-nav

        {
            gap: 10px;
        }

        .app-navbar {
            border-radius: 0;
        }

        }
        media (max-width:991px) {
            .app-navbar

        {
            display: none !important;
        }

        }
        /* Footer */
        .app-footer {
            background: #292e49;
            color: #fff;
            padding: 22px 0 10px 0;
            font-size: 15px;
            margin-top: 44px;
        }
        /* Bottom Nav (Mobile) */
        media (max-width: 991.98px) {
            .bottom-nav

        {
            display: flex !important;
        }

        .app-navbar {
            display: none !important;
        }

        }
        media (min-width: 992px) {
            .bottom-nav

        {
            display: none !important;
        }

        }

        .bottom-nav {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1030;
            background: linear-gradient(90deg, #ffd26c, var(--pt-orange) 80%);
            border-top: 2px solid #ffe5bb;
            box-shadow: 0 -4px 20px #ffdfae44;
            height: 60px;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

            .bottom-nav a {
                flex: 1 1 auto;
                text-align: center;
                color: #292e49;
                font-size: 1.62rem;
                padding: 4px 0 2px 0;
                transition: color 0.17s;
                position: relative;
            }

                .bottom-nav a.active,
                .bottom-nav a:hover {
                    color: var(--pt-orange-dark);
                }

                .bottom-nav a span {
                    display: block;
                    font-size: 11px;
                    line-height: 1.1;
                    color: #333;
                }
        /* Toastify override */
        .toastify {
            font-size: 1.05rem;
        }
    </style>
</head>
<body>
    <!-- Desktop Navbar -->
    <nav class="navbar navbar-expand-lg app-navbar shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="~/images/fraoulapt-logo.png" alt="FraoulaPT Logo" />
                <span>Fraoula<span style="color:var(--pt-orange);font-weight:700;">PT</span></span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="mainNavbar">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item">
                        <a class="nav-link @(ViewContext.RouteData.Values["controller"] as string == "Dashboard" ? "active" : "")" href="/">
                            <i class="bi bi-house-door"></i> Ana Sayfa
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link @(ViewContext.RouteData.Values["controller"] as string == "Package" ? "active" : "")" asp-action="Index" asp-controller="Package">
                            <i class="bi bi-box2-heart"></i> Paketler
                        </a>
                    </li>
                    @if (User.Identity.IsAuthenticated)
                    {
                        <li class="nav-item dropdown ms-2">
                            <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" id="navbarUserDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="padding-right:16px;">
                                <img src="@profilePhoto" alt="@fullName" width="33" height="33" style="object-fit:cover;border-radius:50%;border:2px solid #ff8800;">
                                <span style="font-weight:500;letter-spacing:.02em;color:#fff;">@fullName</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarUserDropdown">
                                <li><a class="dropdown-item" asp-controller="Profile" asp-action="Detail"><i class="bi bi-person"></i> Profilim</a></li>
                                <li><a class="dropdown-item" asp-controller="Profile" asp-action="MyPackage"><i class="bi bi-bag-check"></i> Paketlerim</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" asp-controller="Auth" asp-action="Logout"><i class="bi bi-box-arrow-right"></i> Çıkış</a></li>
                            </ul>
                        </li>

                    }

                    else
                    {
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["action"] as string == "Login" ? "active" : "")" asp-action="Login" asp-controller="Account">
                                <i class="bi bi-door-open"></i> Giriş Yap
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["action"] as string == "Register" ? "active" : "")" asp-action="Register" asp-controller="Account">
                                <i class="bi bi-person-plus"></i> Kayıt Ol
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <!-- Mobile Bottom Nav -->
    <nav class="bottom-nav d-lg-none">
        <a href="/" title="Ana Sayfa" class="@(ViewContext.RouteData.Values["controller"] as string == "Dashboard" ? "active" : "")">
            <i class="bi bi-house-door"></i>
            <span>Ana Sayfa</span>
        </a>
        <a asp-action="Index" asp-controller="Package" title="Paketler" class="@(ViewContext.RouteData.Values["controller"] as string == "Package" ? "active" : "")">
            <i class="bi bi-box2-heart"></i>
            <span>Paketler</span>
        </a>
        <a asp-controller="UserWeeklyForm" asp-action="Index" title="Formlarım" class="@(ViewContext.RouteData.Values["controller"] as string == "UserWeeklyForm" ? "active" : "")">
            <i class="bi bi-journal-check"></i>
            <span>Formlarım</span>
        </a>
        <a asp-controller="WorkoutProgram" asp-action="MyPrograms" title="Antrenmanlarım" class="@(ViewContext.RouteData.Values["controller"] as string == "WorkoutProgram" ? "active" : "")">
            <i class="bi bi-list-task"></i>
            <span>Antrenman</span>
        </a>
        <a asp-controller="Profile" asp-action="Index" title="Profil" class="@(ViewContext.RouteData.Values["controller"] as string == "Profile" ? "active" : "")">
            <img src="@profilePhoto" alt="@fullName" width="25" height="25" style="object-fit:cover;border-radius:50%;border:1.5px solid #ff8800;vertical-align:middle;margin-bottom:3px;">
            <span style="font-size:11px;">@fullName</span>
        </a>
    </nav>
    @if (User.Identity.IsAuthenticated && ViewBag.ProfileIncomplete == true)
    {
        <div class="alert alert-warning mt-3 text-center">
            Profilini tamamlamadın! <a href="/Profile/CompleteProfile">Şimdi tamamla</a>
        </div>
    }
    <!-- Main Content -->
    <main class="main-content pb-4">
        <div class="container">
            @RenderBody()
        </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer text-center">
        <div class="container">
            <div class="pb-2">© @DateTime.Now.Year FraoulaPT | Tüm hakları saklıdır.</div>
            <div style="font-size:13px;opacity:.65;">Sporcu Takip, Kişisel Antrenman ve Online Danışmanlık Platformu</div>
        </div>
    </footer>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.js"></script>
    @await RenderSectionAsync("Scripts", false)

    <script>
            document.addEventListener("DOMContentLoaded", function () {
            var message = '@Html.Raw(TempData["message"])';
            var type = '@TempData["messageType"]';

            if (message) {
                Toastify({
                    text: message,
                    duration: 3000,
                    gravity: "top",
                    position: "center",
                    backgroundColor: type === "success" ? "green" :
                                     type === "error" ? "red" :
                                     type === "warning" ? "orange" : "blue",
                    close: true,
                    style: {
                               background: "linear-gradient(to right, #00b09b, #96c93d)",
                               fontSize: "16px",
                               fontFamily: "Arial, sans-serif",
                               borderRadius: "10px",
                               padding: "16px"
                           }

                }).showToast();
            }
        });
    </script>
</body>
</html>
