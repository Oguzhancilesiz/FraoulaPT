@using FraoulaPT.WebUI.Areas.Admin.Models.ViewModels._Shared
@using FraoulaPT.DTOs.ExerciseCategoryDTOs
@model ExerciseCategoryUpdateDTO

@{
    ViewData["Title"] = "Kategori Düzenle";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    var header = new PageHeaderVM
            {
                Title = "Kategori Düzenle",
                Subtitle = "Mevcut egzersiz kategorisini güncelle",
                Breadcrumbs = new(){
            new(){ Text="Dashboard", Url=Url.Action("Index","Dashboard", new{ area="Admin" }) },
            new(){ Text="Egzersiz Kategorileri", Url=Url.Action("Index","ExerciseCategory", new{ area="Admin" }) },
            new(){ Text="Düzenle" }
        },
                Buttons = new(){
            new(){ Text="Tüm Kategoriler", Url=Url.Action("Index","ExerciseCategory", new{ area="Admin"}), Icon="bi-tags", ColorClass="btn-outline-light" }
        }
            };
}

@await Html.PartialAsync("AdminPartials/_PageHeader", header)

<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-6">
            <div class="card ring shadow-soft">
                <div class="card-body p-3 p-md-4">
                    <form asp-area="Admin" asp-controller="ExerciseCategory" asp-action="Edit" method="post" autocomplete="off" id="categoryForm">
                        @Html.AntiForgeryToken()

                        <input type="hidden" asp-for="Id" />

                        <div class="mb-3">
                            <label asp-for="Name" class="form-label">Kategori Adı</label>
                            <input asp-for="Name"
                                   class="form-control bg-transparent border-secondary text-light"
                                   maxlength="40" required />
                            <div class="d-flex justify-content-between mt-1">
                                <small class="text-muted">Kısa ve anlaşılır bir ad kullanın.</small>
                                <small class="text-muted"><span id="nameCount">0</span>/40</small>
                            </div>
                            <span asp-validation-for="Name" class="text-danger small"></span>
                        </div>

                        <div class="d-flex flex-wrap justify-content-end gap-2 mt-3">
                            <a asp-area="Admin" asp-controller="ExerciseCategory" asp-action="Index"
                               class="btn btn-outline-secondary">Vazgeç</a>
                            <button type="submit" class="btn btn-brand">
                                <i class="bi bi-save me-1"></i> Kaydet
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (function(){
          const input = document.getElementById("Name");
          const count = document.getElementById("nameCount");
          function upd(){ if(input&&count){ count.textContent = (input.value||"").length; } }
          input?.addEventListener("input", upd); upd();

          document.getElementById("categoryForm")?.addEventListener("submit", function(e){
            if(!input) return;
            if((input.value||"").trim().length === 0){
              e.preventDefault();
              input.focus();
            }
          });
        })();
    </script>
}
